<!doctype html>
<html lang="zh-Hant">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>LÃ¨SÃ«n Slideshow</title>

<script async src="https://www.googletagmanager.com/gtag/js?id=G-CJ1LT82YGQ"></script>
<script>
window.dataLayer=window.dataLayer||[];
function gtag(){dataLayer.push(arguments);}
gtag('js',new Date());
gtag('config','G-CJ1LT82YGQ');
</script>

<style>
html,body{margin:0;height:100%;background:#000;overflow:hidden}
.wrap{position:fixed;inset:0;display:flex;align-items:center;justify-content:center}

/* cross-fade */
.slide{position:absolute;max-width:100vw;max-height:100vh;object-fit:contain;opacity:0;transition:opacity 1.4s ease}
.slide.show{opacity:1}

/* ===== HUDï¼ˆæ›´é€æ˜ï¼å„ªé›…é‡‘ï¼‰ ===== */
.hud{
  position:fixed;left:12px;right:12px;bottom:12px;
  display:flex;justify-content:space-between;align-items:center;gap:12px;
  background:linear-gradient(180deg,rgba(10,10,10,.42),rgba(5,5,5,.50));
  backdrop-filter:blur(5px);
  border:1px solid rgba(212,175,55,.18);
  border-radius:18px;
  padding:8px 12px;
  color:#fff;font:14px/1.2 system-ui;
  opacity:.82;z-index:10;
  box-shadow:0 0 18px rgba(212,175,55,.12), inset 0 0 6px rgba(255,255,255,.04);
}
.btns{display:flex;gap:8px;flex-wrap:wrap}
button,select{
  background:linear-gradient(135deg,rgba(40,40,35,.55),rgba(22,22,20,.55));
  border:1px solid rgba(212,175,55,.38);
  color:#f4e9c8;
  padding:8px 10px;border-radius:10px;cursor:pointer;
  box-shadow:0 0 10px rgba(212,175,55,.14), inset 0 0 6px rgba(255,255,255,.06);
  transition:all .2s ease;
}
button.music-on{
  background:linear-gradient(135deg,#f6e7b7,#d4af37);
  color:#2b2208;border:1px solid rgba(255,240,180,.9);
  box-shadow:0 0 14px rgba(255,220,120,.45), inset 0 0 10px rgba(255,255,255,.22);
  font-weight:700;
}
button.music-off{
  background:linear-gradient(135deg,#3a2a2a,#191010);
  color:#ffb8b8;border:1px solid rgba(255,120,120,.55);
  box-shadow:0 0 12px rgba(255,70,70,.32), inset 0 0 8px rgba(60,0,0,.32);
  font-weight:700;
}
.group{display:flex;align-items:center;gap:10px;flex-wrap:wrap}
#counter,#sec{color:#e8dfc8}

/* overlay */
.overlay{position:fixed;inset:0;display:flex;align-items:center;justify-content:center;cursor:pointer;z-index:9999;opacity:0;transform:scale(1.03);transition:opacity .9s ease,transform 1.2s ease}
.overlay.show{opacity:1;transform:scale(1)}
.card{padding:34px 38px;border-radius:18px;text-align:center;background:rgba(255,255,255,.06);border:1px solid rgba(212,175,55,.28);box-shadow:0 0 60px rgba(212,175,55,.12), inset 0 0 30px rgba(255,255,255,.04)}
.brand{font-family:"Playfair Display",serif;font-size:46px;letter-spacing:.16em;margin:0 0 10px;background:linear-gradient(135deg,#fff6df,#e6c36a,#f6e7b7);-webkit-background-clip:text;background-clip:text;color:transparent}
.date{font-family:"Libre Baskerville",serif;font-size:16px;letter-spacing:.18em;color:#e8dfc8;margin:0 0 14px}
.hint{font-size:14px;color:#eae6d8;opacity:.9}

/* å°é¢ä¸»é¡Œï¼ˆç•¥ï¼‰ */
.cover-all{background:radial-gradient(circle at 50% 40%,rgba(255,236,200,.28),rgba(40,55,40,.55) 55%,rgba(8,10,8,.95)),linear-gradient(180deg,#1a2218,#0b0d0a)}
.cover-china{background:radial-gradient(circle at 50% 40%,rgba(180,50,40,.35),rgba(70,20,20,.65) 55%,rgba(15,8,8,.95)),linear-gradient(180deg,#2a1515,#0d0606)}
.cover-vintage{background:radial-gradient(circle at 50% 40%,rgba(210,230,220,.34),rgba(70,90,80,.45) 55%,rgba(12,16,14,.95)),linear-gradient(180deg,#1f2a25,#0c0f0d)}
.cover-modern{background:radial-gradient(circle at 50% 40%,rgba(190,190,190,.18),rgba(60,60,60,.55) 55%,rgba(10,10,10,.95)),linear-gradient(180deg,#1a1a1a,#050505)}
.cover-veil{background:radial-gradient(circle at 50% 40%,rgba(255,255,255,.45),rgba(210,200,180,.35) 55%,rgba(20,18,15,.95)),linear-gradient(180deg,#f2efe8,#15120e)}
.cover-veil .brand{background:linear-gradient(135deg,#e6d8b8,#c9a24a,#a8873a);-webkit-background-clip:text;background-clip:text;color:transparent}

/* èƒŒæ™¯æµå…‰ */
.bg-flow{position:fixed;inset:0;pointer-events:none;z-index:-1;background:radial-gradient(circle at 20% 30%,rgba(255,230,180,.08),transparent 45%),radial-gradient(circle at 80% 70%,rgba(255,210,140,.06),transparent 50%),#000}
.bg-flow::after{content:"";position:absolute;inset:-20%;background:conic-gradient(from 0deg,rgba(255,230,170,.16),rgba(212,175,55,.24),rgba(255,230,170,.16),transparent);filter:blur(36px);opacity:.16;animation:flowOrbit 28s linear infinite}
@keyframes flowOrbit{0%{transform:rotate(0) scale(1.05)}50%{transform:rotate(180deg) scale(1.08)}100%{transform:rotate(360deg) scale(1.05)}}
</style>
</head>

<body>

<div class="bg-flow"></div>

<div class="wrap">
  <img id="imgA" class="slide show">
  <img id="imgB" class="slide">
</div>

<div class="hud">
  <div class="btns">
    <button id="prev">ä¸Šä¸€å¼µ â†</button>
    <button id="toggle">æš«åœ</button>
    <button id="next">ä¸‹ä¸€å¼µ â†’</button>
    <button id="musicToggle" class="music-on">å·²é–‹å•Ÿ ğŸµ</button>
  </div>

  <div class="group">
    <label>å¥—çµ„
      <select id="setSelector">
        <option value="A">All</option>
        <option value="B">China</option>
        <option value="C">90â€™s</option>
        <option value="D">New</option>
        <option value="E">Veil</option>
      </select>
    </label>

    <span id="counter">- / -</span>
    <label>é€Ÿåº¦ <input id="speed" type="range" min="2" max="15" value="3"></label>
    <span id="sec">3s</span>
  </div>
</div>

<div id="overlay" class="overlay cover-all">
  <div class="card">
    <div class="brand" id="coverTitle">LÃ¨SÃ«n Weddingâ™¥</div>
    <div class="date" id="coverDate">January 10, 2026</div>
    <div class="hint">é»ä¸€ä¸‹æ’­æ”¾</div>
  </div>
</div>

<audio id="bgm" preload="auto" loop playsinline></audio>

<script>
const imgA=document.getElementById("imgA"),imgB=document.getElementById("imgB");
let front=imgA,back=imgB;
const counter=document.getElementById("counter"),speed=document.getElementById("speed"),sec=document.getElementById("sec");
const overlay=document.getElementById("overlay"),bgm=document.getElementById("bgm");
const musicToggle=document.getElementById("musicToggle"),setSelector=document.getElementById("setSelector");

let photos=[],i=0,timer=null,playing=false,musicOn=true;
let currentSet=(new URLSearchParams(location.search).get("set")||"A").toUpperCase();
setSelector.value=currentSet;

function normalize(list){return list.map(s=>s.includes("/")?(s.startsWith("./")?s:"./"+s):"./photos/"+s)}

function updateMusicButton(){
  if(musicOn){musicToggle.textContent="å·²é–‹å•Ÿ ğŸµ";musicToggle.classList.remove("music-off");musicToggle.classList.add("music-on")}
  else{musicToggle.textContent="å·²é—œé–‰ ğŸ”‡";musicToggle.classList.remove("music-on");musicToggle.classList.add("music-off")}
}

function render(){
  const src=photos[i];
  back.onload=()=>{back.classList.add("show");front.classList.remove("show");[front,back]=[back,front];counter.textContent=`${i+1} / ${photos.length}`};
  back.src=src;
}

function next(auto=false){i=(i+1)%photos.length;render();if(auto&&i===0){stop();showCover()}}
function prev(){i=(i-1+photos.length)%photos.length;render()}
function start(){stop();playing=true;timer=setInterval(()=>next(true),Number(speed.value)*1000)}
function stop(){if(timer)clearInterval(timer);timer=null;playing=false}

async function playMusic(){try{await bgm.play();musicOn=true}catch{}}
function stopMusic(){bgm.pause();musicOn=false}

function showCover(){overlay.style.display="flex";requestAnimationFrame(()=>overlay.classList.add("show"))}
function hideCover(){overlay.classList.remove("show");setTimeout(()=>overlay.style.display="none",700)}

async function loadSet(set){
  stop();stopMusic();
  overlay.classList.remove("show");overlay.style.display="flex";
  const cfg=await fetch(`./config/${set}.json`).then(r=>r.json());
  overlay.className=`overlay cover-${cfg.coverStyle}`;
  document.getElementById("coverTitle").textContent=cfg.coverTitle;
  document.getElementById("coverDate").textContent=cfg.coverDate;
  bgm.src=cfg.music;
  speed.value=cfg.speedSec;sec.textContent=speed.value+"s";
  photos=normalize(await fetch("./"+cfg.photosJson).then(r=>r.json()));
  i=0;render();updateMusicButton();showCover();
}

overlay.onclick=async ()=>{hideCover();await playMusic();musicOn=true;updateMusicButton();start()};
document.getElementById("next").onclick=()=>next(false);
document.getElementById("prev").onclick=()=>prev();
document.getElementById("toggle").onclick=()=>playing?stop():start();

musicToggle.onclick=async ()=>{if(musicOn){stopMusic();musicOn=false}else{await playMusic();musicOn=true}updateMusicButton()};
speed.oninput=()=>{sec.textContent=speed.value+"s";if(playing)start()};
setSelector.onchange=async ()=>{currentSet=setSelector.value;history.replaceState(null,"",`?set=${currentSet}`);await loadSet(currentSet)};

loadSet(currentSet);
</script>

</body>
</html>